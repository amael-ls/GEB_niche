
\section{Discussion}
We developed a model to investigate how climate and competition determine continental-scale variation in tree demography. We modelled variation in radial growth and mortality and, when combined with values for the effective fecundity from the literature, we derived the population growth rate $ R_0 $ for size-structured populations. We re-described $ R_0 $ as $ \rho_0 $ when using the fecundity function of \citet{Purves2008} and scaled it accordingly (\ie $ \tilde \rho_0 $) to emphasise spatial variation in demography under constant fecundity. We then correlated $ \tilde \rho_0 $ with occurrence probabilities where competition was absent or present, and found marked variation among species and competition levels, which ranged from negative to positive. Our method advances previous analyses of ontogenic growth \citep{McGill2012, Thuiller2014}, by including explicit representations of the complex history of forest stands (\ie tree cohorts), the abiotic environment, and species interactions. These three mechanisms commonly shape species responses to climate change, together with dispersal, evolution and physiology \citep{Urban2016}. Yet, adding demography, environment, and species interactions for size-structured population models comes with trade-offs: more detailed models are data-intensive and might require specific information, while increasing the complexity of parameter estimations. Our approach was computationally challenging, given that it combines \num{3816854} tree measurements to climate data and competition (computed using \num{7704442} measurements). Finally, we tested whether species performance declines towards species range limits, while accounting for competition, and found no support for this hypothesis for most species. Overall, our results demonstrate an extreme variability in growth and mortality rates and the difficulties that relate tree demography to species distributions.

\subsection{From climate to occurrence through demography}
\subsubsection{Climate effect on radial growth and mortality}
Both individual growth and mortality were highly variable along the broad investigated climatic gradient. There is a long tradition in dendrochonological studies (\eg \citet{Aussenac2017}) of relating variation in annual growth of individual trees to inter-annual variation in climate. Yet, it appears that the effect of climate on demography is more difficult to detect when comparing the average performance of individual trees across a large biogeographic area, especially when we integrate growth and mortality over the entire life cycle of a forest stand. Many other factors may condition forest dynamics beyond the effect of climate \citep{Zhang2015}. Tree demography is likely to be a high-dimensional process \citep{Clark2011} that is affected by several individual level constraints, such as genetics, soil properties, micro-topography, forest composition, pests, and tree and stand history. Tree mortality is also a slow and cumulative process that may be difficult to represent with discrete information such as stem diameter, average climate, and neighbourhood composition. Models such as the ones that we investigated could not properly account for external causes of death, such as physical damage \citep[uprooting, stem breakage, crushing by other falling trees]{Larson2010} or dieback. Our observations that plot random effects are large relative to the effects of climatic variables is good evidence that this individual/site level variation is driving much of the uncertainty in tree demography across the climatic gradient. Including all of these extra variables in growth and mortality models (provided we have proper information and functions to represent their effects) would certainly aid in reducing the uncertainty in the functions that relate demography to climate. That being said, individual conditions such as past history and micro-site properties are highly variable and unpredictable in nature. This means that even though we could improve further growth and mortality models by trimming residual variation, the uncertainty in some of the conditioning variables would propagate and still make demography highly variable across climatic gradients. In other words, the stochastic variation in individual conditions is simply overwhelming the deterministic effect that climate alone exerts on growth and mortality, thereby precluding any significant effect of demography on species distributions.

\subsubsection{Competition effect on radial growth and mortality}
Despite the substantial variability that we observed, we found that radial growth and mortality are strongly influenced by asymmetrical competition for light. We have found a relationship between shade tolerance and the effect of light competition for both growth ($ G $) and mortality ($ \mu $). It suggests that not only understorey tree survival, but also understorey tree growth could help to quantify tree species competitive ability, although this analysis should be approached with caution \citep{Feng2018}. Notwithstanding that the response of growth to climate being mediated by the canopy status, we did not further explore the interaction between climate and light competition for our 14 species. We already know that the growth response of these species to adverse climate conditions is buffered by neighbourhood interspecific competition \citep{Aussenac2019}. Understanding the effect that light competition plays in tree demography is, therefore, of primary importance and requires dedicated studies, given that light and water availability act non-linearly on plant performance \citep{Holmgren2012}. The dominance of size and competition effects over climate in our models demonstrates the importance of considering population structure in forest dynamics. Our derivation of an integrated measure of performance across the life cycle is needed to properly investigate the variation in demography across large areas. \\

Our two-state canopy model cannot compare with a ten-layer model as proposed by \citet{Lischke1998}, which might explain why competition had little effect on correlations between probabilities of occurrence and species performance. However, two layers were sufficient to detect a joint effect of climate and competition for light on species distributions. In the absence of competition, we found that every species exhibited positive population growth rates across most of their ranges (Table S5.3). When adding competition (canopy height $ \s_c = 10 $ m), boreal species had a substantial reduction in the proportion of the range with positive growth, from $ 0.01 \% $ (\textit{Thuja occidentalis}) to $ 99 \% $ (\textit{Pinus banksiana}). It is possible that we underestimated $ \tilde \rho_0 $ in northern locations because we had set a standard canopy height of $ 10 $ m across regions, and we did not consider variation in the allometric relationships that we used. Among the other species, \textit{Populus tremuloides} lost $ 66 \% $ of suitable locations within its range $ \Omega $ with the addition of competition, while \textit{Acer rubrum} lost $ 28 \% $ (see Supporting Information Appendix S5). \textit{Populus tremuloides} is classified as very shade-intolerant \citep{Burns1990a}; thus, declines in its growth due to competition could be expected, as recruitment does not occur continuously in the understorey. We did not include disturbances in our model, but these may play a major role in maintaining this pioneer species in Eastern Canada \citep{Nlungu-Kweta2017}. Population growth rates were positive for all the other species within their distributions, regardless of the presence or absence of competition. This response supports previous studies showing that species geographic distributions ($ \Omega $) are within species' ecological niches \citep{Lee-Yaw2016, Csergo2017}.

\subsubsection{Relationship between demography and distribution}
The net reproduction rate $ \rho_0 $ (and equivalently, $ \tilde \rho_0 $) is a heuristic tool to summarise how individual growth, mortality, and seed production collectively define species persistence. We found four drivers that we can alter to change $ \rho_0 $: the competition, the average understorey growth, the average mortality rate, and the fecundity function. The combination of these four drivers can represent the growth-survival trade-off (\eg the ratio of mortality over radial growth $ \sfrac{\mu}{G} $ appearing in equation \eqref{eq::rho0}) and the stature-recruitment trade-off (distinguishes long-lived pioneers from short-lived breeders). These two trade-offs are important for understanding forest dynamics \citep[for tropical forest]{Ruger2020}. \\

We found little support for the hypothesis that tree species should be distributed where they perform the best: there are very low positive correlations between $ \tilde \rho_0 $ and occurrence probabilities. We compared the effects of using random forests rather than presence/absence data, but found no difference in the trends (Supporting Information Appendix S6). Given the high $ R_{\text{Tjur}}^{2} $, we cannot attribute the lack of correlation to the random forest algorithm used to smooth the occurrence probabilities for the different tree species across their distributions. Our study adds to a growing body of literature on this subject \citep[and references therein]{Holt2020}. For instance, a similar lack of correlation has been found for European trees \citep[using matrix projection models]{Csergo2017} and for western North American species along moisture gradients \citep{Bohner2019}. Local interactions are hypothesised to preclude SDMs from predicting population growth rates when fitted to macroclimate data \citep{Csergo2017}. Although competition for light is important, our results show that there might be other mechanisms underlying abundance or population growth rates. For example, certain species have undergone negative density-dependence \citep[for rare species]{Yenni2012}, while certain common species are limited by plant-soil feedbacks \citep[\textit{Acer saccharum}]{Solarik2019}. \\

Competition influenced correlations of the population growth rate $ \tilde \rho_0 $ with the probability of occurrence ($ P_{occ} $) and with distance to the closest edge (Figs. \ref{fig::3correls}; Supporting Information Appendix S6). For all the boreal species, except for \textit{Abies balsamea}, competition attenuated the signal between $ P_{occ} $ and $ \tilde \rho_0 $ by reducing the correlation to a value closer to 0. As previously discussed, a canopy height of $ 10 $ m might be too great in comparison to what is generally found beyond a certain latitude. For the same reason, the correlations between $ \tilde \rho_0 $ and distance to the closest edge might have been masked by competition. For \textit{Betula papyrifera, Picea mariana} and \textit{Thuja occidentalis}, for example, we found support for declining performance toward species range edges, but exclusively in open canopies. Thus, competition might have an important role at the northern border of certain species through its influence on demography. The effects of competition at range edges have recently been investigated for European trees, with a different outcome: competition was a strong determinant of vital rates, but its effect was not stronger at the edge than at the centre of the distribution \citep{Kunstler2019}. In spite of this response, the authors also found a weak support for declining performance at the range edge (the Abundant Centre Hypothesis). For most species, we found that $ \tilde \rho_0 $ monotonically increased towards their northern or southern boundaries but not toward their centres (Fig. \ref{fig::grad_cols} and Supporting Information S5).


\subsection{Tree demography beyond growth and mortality}
\subsubsection{Fecundity}
It is difficult to cover the full range of a tree's life cycle and study its specific relationships with climate. Our model does not account for spatial variability in seed production, seed survival or germination, for which very little is known and documented. We used $ \tilde \rho_0 $ instead of $ \rho_0 $ to tease apart the fecundity term. This measure can be compared directly between species to observe trends in population performance within a landscape when species' fecundities are kept constant. While the threshold value allowing species persistence is always 1 when using the un-scaled population growth rates $ \rho_0 $, it becomes species-specific when using $ \tilde \rho_0 $. Our study also overlooked seedling growth and survival because no data are available for individual trees below a certain diameter. The ensemble of processes, from seed to seedling survival, describes the recruitment niche, which defines the requirements that allow a seed to germinate and establish \citep{Valdez2019}. Different studies that focus upon a single species \citep[\textit{Acer saccharum}]{Solarik2016}, or along either a longitudinal gradient \citep{CLARK2011}, or a latitudinal gradient \citep{Boisvert-Marsh2019}, provide good evidences of the role that climate plays in shaping the recruitment niche. More specifically, seed production, rather than tree growth and mortality, was found to be the most responsive to spring temperature and summer drought \citep[11 sites in the Appalachians and Piedmont of North Carolina]{CLARK2011}. Soil properties and pathogens were found to constrain the regeneration of trees even more strongly than did climate \citep[Mont M\'{e}gantic, Qu\'{e}bec]{Brown2014}. These studies corroborate the plethora of mechanisms underlying population growth rates, and underscore our need for more data on the juvenile stage, at least to avoid extrapolating demographic rates that have been estimated mostly from adult trees ($ dbh \geqslant 100 $ mm) to saplings. A sensitivity analysis of $ \tilde \rho_0 $ with respect to the three vital rates is necessary to make further process and to distinguish which demographic parameter is the most important in the context of climate change, and for which species, at which stage, and at which part of the range.

\subsubsection{Dispersal}
We posed the hypothesis of local dispersal, using a Dirac distribution (\ie the dispersion does not appear in our equation) for the sake of tractability. Therefore, $ \tilde \rho_0 $ is a quantity derived only from demographic processes, neglecting potential effects of source and sink dynamics on distribution. The role of dispersal in tree distribution is controversial: certain studies have reported that long-distance dispersal determines the migration rate of trees and can explain some species shifts \citep[and references therein]{Nathan2002}, while other studies have argued that micro-refugia (small patches beyond the main distribution) play a major role in colonisation \citep[and references therein]{Feurdean2013}. These hypotheses could be investigated numerically with our model by developing an algorithm adapted to transport equations, such as \eqref{eq::dynamics_x}. However, retrieving analytical results would requires simpler radial growth and mortality functions.

\subsection{Looking forward}
Even though $ \rho_0 $ has useful theoretical properties (Supporting Information Appendix S1), it is too early to use it in assisted migration debates and forest management. Nevertheless, we note that some species exhibited low values of $ \rho_0 $ in the southern portion of their distribution, but increased moving northward, which might be a sign of future mismatches between their niches and their distributions. This is particularly true for \textit{Acer rubrum}, which is projected to have extinction debts in the south \citep{Talluto2017a}. Species that are poorly dispersed and highly persistent might be more subject to niche-distribution mismatches \citep[on shrubs, not trees, in the family Proteaceae in South Africa]{Pagel2020}. It is, therefore, important to discern which scale is the best to understand how tree distributions emerge from forest dynamics. \\

Tree demography is a multidimensional process resulting from individual's characteristics (\eg genetics, history, size), and from local conditions that are entangled with regional processes. One way to acknowledge our incomplete understanding or the high degree of variability in demography is to use stochasticity in modelling processes, at the cost of losing the analytical population growth rate. Integral Projection Models (IPMs) are stage- or size-structured models, like ours, and are promising tools to model forest dynamics \citep{Vindenes2012, Kunstler2019, Merow2014}. IPMs can integrate stochasticity into demography, which is a major feature as chance plays a significant role in lifetime reproductive success variance and, by extension, in $ R_0 $'s variance \citep{Snyder2016, Snyder2018}.

\section{Conclusion}
Our study stresses that using climate through demographic rates is not enough to explain species distributions, even though we accounted for forest structure and competition for light via a simplified method. Therefore, climatic niche should be used circumspectly, as the underlying processes of species occurrence remain unclear. We demonstrated that climate plays either a minor or an unpredictable role in tree demography. Hence, other factors such as stochastic extinction, dispersal limitation, sink populations or Allee Effects \citep[and references therein]{Holt2005} should be investigated to understand tree range dynamics. We showed that individual processes (according to the manner in which we estimated them) contributed very little to tree distributions as well. Therefore, tree dynamics cannot rely exclusively upon demographic rates that are determined by local spatial processes; they should also include phenomena that can be perceived mostly at the meta-population scale, such as fire dynamics. Our study underlines the need to mix scales and to use integrated population modelling \citep{Isaac2020}.
