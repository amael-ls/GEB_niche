
% Deleted references: \citep{Levin2009}, \citet{Schurr2012}, \citep{Canham2004, Canham2006}

\section{Introduction}

A common, but rarely tested, assumption in ecology is that a species is more likely to be found in a location where it performs the best. Indeed, probability of occurrence across a species' range should be positively correlated with its per capita intrinsic growth rate \citep{McGill2012}. Hutchinsonian niche theory \citep{Hutchinson1957, Maguire1973} posits that species are limited to locations where environmental conditions (\ie properties external to the organism) allow a population to persist. This hypothesis is at the core of species distribution models, and can be used to identify climatic variables constraining species ranges, whilst their projection into the future can forecast potential range shifts. \\

The most concise formulation of this niche theory relates population growth rate $ r $ to the species' niche: the hypervolume formed by the environmental factors space is the set, such that $ r \geqslant 0 $ \citep{Holt2009, Godsoe2017}. Formally, let $ r_i(\bm{E}, \bm{R}) $ be the growth rate of a focal species $ i $ when rare, viz., the intrinsic growth rate for a given environment $ \bm{E} $ and quantity of resources $ \bm{R} $. The equation
\[
	r_i(\bm{E}, \bm{R}) \geqslant 0,
\]
specifies that the fundamental niche corresponds to locations where $ \bm{E} $ and $ \bm{R} $ allow positive growth. An equivalent representation is the lifetime number of recruits per individual, which is traditionally denoted by $ R_{0, i} $ \citep[where $ i $ is still the species index]{Pulliam2000, DeRoos1997}. A sustainable population requires that $ R_{0, i} (\bm{E}, \bm{R}) \geqslant 1 $, where an individual must to at least replace itself over its lifespan. This definition of niche allows species $ i $ to influence rates of other species within the community, while responding to feedbacks on its own demographic rates. Hereafter, we drop index $ i $, but it is important to remember that $ R_{0, i} $ is a species-specific rate related to species $ i $. \\

Difficulties in testing niche theory are partially rooted in the challenge of measuring population growth rates \citep{McGill2012}, especially for physiologically structured populations \citep{Diekmann1990}. For instance, the age or size of an individual influences its reproduction success, feeding behaviour, or death probabilities. When combined with density-dependences and environmental influences, these age and size structures might blur the relationship between a species' occurrence and its variations in $ R_0 $ along an environmental gradient. Yet, individual-based structured-population models can bring insight to addressing the complexity of population dynamics. Such models, however, are demanding in terms of their parameterisation, and difficult to analyse. Good examples are forest trees, which can be modelled by spatially explicit simulators that account for single-tree development and availability of light to an individual (\eg \citet{Pacala1993}). These forest simulators focus upon the individual level, which is the scale relevant for studying competition and climate responses. Yet, interesting questions typically relating to biogeography (including tree species distributions) lie at the population level, that is to say, with $ R_0 $. \\

The relationship between tree species ranges and population growth has recently come under scrutiny, both in Europe \citep{Thuiller2014} and in north-eastern North America \citep{McGill2012}. Little correspondence has been found between $ r $ and tree species distributions due to uncertainty that is associated with demographic parameters \citep{Thuiller2014}. Negative correlations were even found, which challenges the common assumption that a species is most abundant in its optimal environment \citep{McGill2012}. The Inclusive Niche was proposed as an alternative explanation to these negative correlations. Here, weak competitors have their fundamental niche reduced to a smaller realised space, in a trade-off between competitive ability and environmental tolerance \citep{Serrano2015}. Therefore, weak competitors can be more abundant in suboptimal environments. \\

Dynamic Range Models (DRMs) have been developed recently to get closer to individual demographic rates, while scaling up to the population level \citep{Pagel2012}. DRMs are hierarchical statistical models that relate species' abundances to environmental data using two latent variables: population growth rate $ r $, and dispersal. These models also can track uncertainties in the data that arise at the demographic level, biogeographic level, and observer level. \\

Currently, no standard method exists that would derive a single performance index from demographic rates \citep{Purves2009}. Thus, all studies linking species distributions to individual performance lie in the midst of `uncharted territory'. Indeed, \cite{McGill2012, Thuiller2014, Pagel2012} have explored very different ways of linking distributions to population performance. Yet, they have all agreed that combining the three vital rates, namely, individual growth, mortality, and fecundity into $ r $, is difficult and that $ r $ itself cannot be easily derived from censuses. Building upon these papers, we derive $ r $ from a forest dynamics model that uses the three vital rates. In this paper, we focus exclusively on radial growth and mortality, and make them life-stage-dependent, which is of primary importance in propagating uncertainties up to $ r $ \citep[$ \lambda $ in his article]{Clark2003b}. \\

Our main objective in this study is to investigate whether the distribution of North American tree species is driven by the effect of climate and light competition on individual demography. The Abundant-Centre Hypothesis postulates that demographic performance should decline toward range margins \citep{Sagarin2002}. We therefore investigate two predictions that (\textit{i}) per capita growth rate should vary with climate and as a result, (\textit{ii}) per capita growth rate should decline at range margins where occurrence probabilities tend to zero. We represent forest stand dynamics with a cohort-based model that relies on McKendrick-von Foerster equations \citep{Strigul2008}. This model relates individual tree demography to cohort dynamics, thereby accounting for neighbourhood competition and ontogenetic variation in demography. We derive a formula from the McKendrick-von Foerster equations to combine individual tree growth, mortality and fecundity rates into $ R_0 $, \ie the per capita growth rate. We then evaluate how components of tree demography (individual growth and mortality) respond to climate, individual size, and competition. We expect an optimal climate for each species within the middle of its range, with better performance under light than shade conditions. Thereafter, we test whether $ R_0 $ is positively correlated to the probability of occurrence and whether it declines towards range limits. The analysis is performed for the 14 most abundant tree species that are native to eastern North America.
